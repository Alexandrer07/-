<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ: –ú–∞—Ä–∏–∏–Ω—Å–∫–∏–π -> –≠—Ä–º–∏—Ç–∞–∂</title>
    <style>
        /* –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç–∏–ª–∏ */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #2c3e50;
            margin: 0;
            padding: 20px;
            color: #333;
            text-align: center;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        h1 { color: #ecf0f1; text-transform: uppercase; letter-spacing: 2px; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); }

        /* –ò–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ */
        .game-board {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 12px;
            max-width: 1150px;
            margin: 0 auto 30px auto;
            background: #fff;
            padding: 20px;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.6);
        }

        .cell {
            width: 125px;
            height: 145px;
            border: 3px solid #bdc3c7;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            padding-top: 10px;
            position: relative;
            background-color: #ecf0f1;
        }

        .cell.start { background-color: #ffeaa7; border-color: #fdcb6e; }
        .cell.finish { background-color: #55efc4; border-color: #00b894; }
        .cell.location { background-color: #74b9ff; border-color: #0984e3; color: white; }
        .cell.traffic { background-color: #ff7675; border-color: #d63031; color: white; }
        .cell.crosswalk { 
            background: repeating-linear-gradient(45deg, #636e72, #636e72 10px, #dfe6e9 10px, #dfe6e9 20px);
            border-color: #2d3436;
        }

        .cell-icon { font-size: 42px; margin-bottom: 5px; }
        .cell-title { font-size: 11px; font-weight: bold; text-transform: uppercase; padding: 0 5px; line-height: 1.1; }
        .cell-number { position: absolute; top: 4px; left: 6px; font-size: 11px; font-weight: bold; color: #7f8c8d; }

        /* –§–∏—à–∫–∏ */
        .tokens-area {
            display: flex;
            justify-content: center;
            gap: 4px;
            flex-wrap: wrap;
            margin-top: auto;
            margin-bottom: 8px;
            width: 100%;
        }

        .token {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            color: white;
            font-weight: bold;
            font-size: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid white;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.4);
        }
        .token.plus { background-color: #e84393; }
        .token.minus { background-color: #0984e3; }
        .token.mult { background-color: #00b894; }

        /* –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è */
        .controls {
            background: white;
            max-width: 850px;
            margin: 0 auto 20px auto;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
        }

        #question-display {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 25px;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 15px;
            border-left: 12px solid #f39c12;
            min-height: 100px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .answer-text {
            color: #27ae60;
            margin-top: 15px;
            font-size: 28px;
            font-weight: 900;
            border-top: 3px dashed #eee;
            padding-top: 15px;
        }

        .btn-row { display: flex; justify-content: center; gap: 20px; flex-wrap: wrap; }
        
        button {
            padding: 18px 30px;
            font-size: 20px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            color: white;
            box-shadow: 0 5px 0 rgba(0,0,0,0.2);
        }
        button:active { transform: translateY(3px); box-shadow: 0 2px 0 rgba(0,0,0,0.2); }

        .btn-plus { background-color: #e84393; }
        .btn-minus { background-color: #0984e3; }
        .btn-mult { background-color: #00b894; }
        .btn-next { background-color: #f39c12; width: 100%; max-width: 350px; }
        .btn-start { background-color: #2c3e50; width: 100%; max-width: 350px; }

        #log-message { margin-top: 25px; font-weight: bold; font-size: 20px; color: #2c3e50; }

        /* –ü–æ–¥–ø–∏—Å—å */
        footer {
            margin-top: auto;
            padding: 20px;
            font-size: 12px;
            color: #95a5a6;
        }
    </style>
</head>
<body>

    <h1>–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ –ø–æ –ü–µ—Ç–µ—Ä–±—É—Ä–≥—É</h1>

    <div class="game-board" id="board"></div>

    <div class="controls">
        <div id="question-display">–ù–∞–∂–º–∏—Ç–µ –°–¢–ê–†–¢, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –∏–≥—Ä—É!</div>
        
        <div id="start-area">
            <button class="btn-start" onclick="initGame()">–ù–ê–ß–ê–¢–¨ –ò–ì–†–£</button>
        </div>

        <div id="next-area" style="display: none;">
            <button class="btn-next" onclick="revealAnswer()">–ü–û–ö–ê–ó–ê–¢–¨ –û–¢–í–ï–¢</button>
        </div>

        <div id="play-area" style="display: none;">
            <p style="margin-bottom: 15px; font-weight: bold;">–ö—Ç–æ –æ—Ç–≤–µ—Ç–∏–ª –ø—Ä–∞–≤–∏–ª—å–Ω–æ?</p>
            <div class="btn-row">
                <button class="btn-mult" onclick="makeMove('mult')">–£–º–Ω–æ–∂–µ–Ω–∏–µ (√ó)</button>
                <button class="btn-plus" onclick="makeMove('plus')">–ü–ª—é—Å (+)</button>
                <button class="btn-minus" onclick="makeMove('minus')">–ú–∏–Ω—É—Å (‚àí)</button>
            </div>
        </div>

        <div id="log-message"></div>
    </div>

    <footer>–∞–≤—Ç–æ—Ä –ê–ª–µ–∫—Å–∞–Ω–¥—Ä –ö—É–∑–Ω–µ—Ü–æ–≤</footer>

<script>
    const mapConfig = [
        { name: "–ú–∞—Ä–∏–∏–Ω—Å–∫–∏–π —Ç–µ–∞—Ç—Ä", type: "start", icon: "üé≠" },
        { name: "–°–≤–µ—Ç–æ—Ñ–æ—Ä", type: "traffic", icon: "üö¶" },
        { name: "–ü–µ—Ä–µ—Ö–æ–¥", type: "crosswalk", icon: "" },
        { name: "–ü–µ—Ç–µ—Ä–≥–æ—Ñ", type: "location", icon: "‚õ≤Ô∏è" },
        { name: "–°–≤–µ—Ç–æ—Ñ–æ—Ä", type: "traffic", icon: "üö¶" },
        { name: "–ü–µ—Ä–µ—Ö–æ–¥", type: "crosswalk", icon: "" },
        { name: "–¶–∞—Ä—Å–∫–æ–µ —Å–µ–ª–æ", type: "location", icon: "üëë" },
        { name: "–°–≤–µ—Ç–æ—Ñ–æ—Ä", type: "traffic", icon: "üö¶" },
        { name: "–ü–µ—Ä–µ—Ö–æ–¥", type: "crosswalk", icon: "" },
        { name: "–ò—Å–∞–∞–∫–∏–µ–≤—Å–∫–∏–π —Å–æ–±–æ—Ä", type: "location", icon: "‚õ™Ô∏è" },
        { name: "–°–≤–µ—Ç–æ—Ñ–æ—Ä", type: "traffic", icon: "üö¶" },
        { name: "–ü–µ—Ä–µ—Ö–æ–¥", type: "crosswalk", icon: "" },
        { name: "–≠—Ä–º–∏—Ç–∞–∂", type: "finish", icon: "üèõ" }
    ];

    const questionsBase = [
        { q: "–í –∫–∞–∫–æ–º –≥–æ–¥—É –æ—Å–Ω–æ–≤–∞–Ω –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥?", a: "1703" },
        { q: "–ì–ª–∞–≤–Ω–∞—è —Ä–µ–∫–∞ –≥–æ—Ä–æ–¥–∞?", a: "–ù–µ–≤–∞" },
        { q: "–ö—Ç–æ –æ—Å–Ω–æ–≤–∞–ª –≥–æ—Ä–æ–¥?", a: "–ü—ë—Ç—Ä I" },
        { q: "–°–∞–º—ã–π –∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ä–∞–∑–≤–æ–¥–Ω–æ–π –º–æ—Å—Ç?", a: "–î–≤–æ—Ä—Ü–æ–≤—ã–π" },
        { q: "–°–∫–æ–ª—å–∫–æ –∫–æ–Ω–µ–π –Ω–∞ –ê–Ω–∏—á–∫–æ–≤–æ–º –º–æ—Å—Ç—É?", a: "4 –∫–æ–Ω—è" },
        { q: "–ì–ª–∞–≤–Ω—ã–π –º—É–∑–µ–π –≤ –ó–∏–º–Ω–µ–º –¥–≤–æ—Ä—Ü–µ?", a: "–≠—Ä–º–∏—Ç–∞–∂" },
        { q: "–ö–∞–∫ –Ω–∞–∑—ã–≤–∞—é—Ç—Å—è —Å–≤–µ—Ç–ª—ã–µ –Ω–æ—á–∏ –ª–µ—Ç–æ–º?", a: "–ë–µ–ª—ã–µ –Ω–æ—á–∏" }
    ];

    let questions = [];
    let currentQuestion = null;
    let players = {
        'mult': { symbol: "√ó", pos: 0, class: "mult", name: "–£–º–Ω–æ–∂–µ–Ω–∏–µ" },
        'plus': { symbol: "+", pos: 0, class: "plus", name: "–ü–ª—é—Å" },
        'minus': { symbol: "‚àí", pos: 0, class: "minus", name: "–ú–∏–Ω—É—Å" }
    };

    function drawBoard() {
        const board = document.getElementById('board');
        board.innerHTML = '';
        mapConfig.forEach((cell, i) => {
            board.innerHTML += `
                <div class="cell ${cell.type}">
                    <div class="cell-number">${i}</div>
                    <div class="cell-icon">${cell.icon}</div>
                    <div class="cell-title">${cell.name}</div>
                    <div class="tokens-area" id="cell-tokens-${i}"></div>
                </div>`;
        });
        renderTokens();
    }

    function renderTokens() {
        document.querySelectorAll('.tokens-area').forEach(a => a.innerHTML = '');
        for (let key in players) {
            const p = players[key];
            const area = document.getElementById(`cell-tokens-${p.pos}`);
            if (area) {
                area.innerHTML += `<div class="token ${p.class}">${p.symbol}</div>`;
            }
        }
    }

    function initGame() {
        for (let key in players) players[key].pos = 0;
        questions = [...questionsBase].sort(() => Math.random() - 0.5);
        document.getElementById('start-area').style.display = 'none';
        drawBoard();
        askQuestion();
    }

    function askQuestion() {
        if (questions.length === 0) questions = [...questionsBase].sort(() => Math.random() - 0.5);
        currentQuestion = questions.pop();
        document.getElementById('question-display').innerHTML = `–í–û–ü–†–û–°: ${currentQuestion.q}`;
        document.getElementById('next-area').style.display = 'block';
        document.getElementById('play-area').style.display = 'none';
        document.getElementById('log-message').innerText = "";
    }

    function revealAnswer() {
        document.getElementById('question-display').innerHTML += `<div class="answer-text">–û–¢–í–ï–¢: ${currentQuestion.a}</div>`;
        document.getElementById('next-area').style.display = 'none';
        document.getElementById('play-area').style.display = 'block';
    }

    function makeMove(playerKey) {
        const r = Math.random() * 100;
        let steps = 0;

        // –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å: 3 (85%), 4 (10%), 5 (5%)
        if (r < 85) steps = 3;
        else if (r < 95) steps = 4;
        else steps = 5;

        const p = players[playerKey];
        p.pos += steps;

        if (p.pos >= mapConfig.length - 1) {
            p.pos = mapConfig.length - 1;
            renderTokens();
            document.getElementById('question-display').innerHTML = `üèÜ –ü–û–ë–ï–î–ê! –ö–æ–º–∞–Ω–¥–∞ "${p.name}" –¥–æ—à–ª–∞ –¥–æ –≠—Ä–º–∏—Ç–∞–∂–∞!`;
            document.getElementById('play-area').style.display = 'none';
            document.getElementById('start-area').style.display = 'block';
            return;
        }

        renderTokens();
        document.getElementById('log-message').innerHTML = `–ö–æ–º–∞–Ω–¥–∞ ${p.name} +${steps} —à–∞–≥–∞. –°—Ç–∞–Ω—Ü–∏—è: ${mapConfig[p.pos].name}`;
        document.getElementById('play-area').style.display = 'none';
        setTimeout(askQuestion, 2000);
    }

    drawBoard();
</script>
</body>
</html>